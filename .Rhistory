ggsave(filename = file.path(results_dir, "CUE_vs_Competition.pdf"), plot = p_comp,
device = cairo_pdf, width = 21, height = 12, units = "cm", dpi = 600, bg = "white")
cat("Saved to:", file.path(results_dir, 'CUE_vs_Competition.pdf'), "\n\n")
#!/usr/bin/env Rscript
# b_analysis.R (simplified, ggplot2-based output like thesis.R)
library(ggplot2)
library(dplyr)
# Read data and set output directory
df <- read.csv("/Users/jiayi/Desktop/micrm/master_project/data/b_analysis_data_0.2.csv")
results_dir <- "/Users/jiayi/Desktop/micrm/master_project/results"
cat("Data loaded. Rows:", nrow(df), ", Columns:", ncol(df), "\n\n")
# Palette and theme (match thesis.R styling)
pal_rgb <- c("1" = "#E74C3C",   # 红
"2" = "#2ECC71",   # 绿
"3" = "#3498DB")   # 蓝
base_theme <- theme_minimal(base_size = 14) +
theme(
text       = element_text(family = "Times New Roman"),
axis.text  = element_text(family = "Times New Roman", size = 14),
axis.title = element_text(family = "Times New Roman", size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border     = element_rect(color = "black", fill = NA, size = 0.5),
axis.ticks       = element_line(color = "black", size = 0.3)
)
# Helper: reshape wide columns (1/2/3) to long for plotting
make_long <- function(df, prefix_x, prefix_y, names = c("1","2","3")){
n <- nrow(df)
data.frame(
Community = factor(rep(names, each = n), levels = names),
x = c(df[[paste0(prefix_x, names[1])]], df[[paste0(prefix_x, names[2])]], df[[paste0(prefix_x, names[3])]]),
y = c(df[[paste0(prefix_y, names[1])]], df[[paste0(prefix_y, names[2])]], df[[paste0(prefix_y, names[3])]])
)
}
# 1) Facilitation vs CUE (ggplot) ------------------------------------------
feed_df <- make_long(df, prefix_x = "C_feed", prefix_y = "CUE")
p_feed <- ggplot(feed_df, aes(x = x, y = y, color = Community, shape = Community)) +
geom_point(alpha = 0.8, size = 1.8) +
scale_color_manual(values = pal_rgb) +
scale_shape_manual(values = c("1" = 16, "2" = 17, "3" = 15)) +
labs(x = "Facilitation", y = "CUE", title = "CUE vs Facilitation", color = "Community", shape = "Community") +
base_theme
ggsave(filename = file.path(results_dir, "CUE_vs_Facilitation.pdf"), plot = p_feed,
device = cairo_pdf, width = 21, height = 12, units = "cm", dpi = 600, bg = "white")
install.packages("Cairo")
library(Cairo)
library(dplyr)
# change to your own directory
setwd("/Users/jiayi/Desktop/metagenomic_pipeline/QIIME/Scripts")
# Read feature table (ASV counts per sample)
# biom->TSV files usually have:
#  line 1: "# Constructed from biom file"
#  line 2: "#OTU ID\tSample1\tSample2..."
ft_path <- '../Results/denoise_mode_gg/exported-table/feature-table.tsv'
feature_table_lines <- readLines(ft_path)
# Locate the header line that starts with "#OTU ID"
header_idx <- which(grepl('^#OTU ID', feature_table_lines))[1]
if (is.na(header_idx)) {
stop('Could not find header line beginning with "#OTU ID" in feature-table.tsv')
}
# Extract column names from that header (remove leading #)
header_raw <- sub('^#', '', feature_table_lines[header_idx])
col_names <- strsplit(header_raw, '\t')[[1]]
# Fallback: if not tab-delimited for some reason, split on whitespace
if (length(col_names) == 1L) {
col_names <- strsplit(header_raw, '\\s+')[[1]]
}
# Read the data lines after the header line
feature_table <- read.table(ft_path,
sep='\t', header=FALSE, row.names=1,
skip=header_idx, check.names=FALSE,
comment.char='')
# Assign correct column names (skip first column name which is for row names)
if (length(col_names) - 1L != ncol(feature_table)) {
stop(sprintf('Column name count mismatch: header has %d data columns, table has %d',
length(col_names) - 1L, ncol(feature_table)))
}
colnames(feature_table) <- col_names[-1]
# Read taxonomy (Feature ID -> Taxon mapping)
taxonomy <- read.table('../Results/denoise_mode_gg/exported-taxonomy/taxonomy.tsv',
sep='\t', header=TRUE, row.names=1)
# Extract only the Taxon column from taxonomy
taxonomy_only <- data.frame(Taxon = taxonomy$Taxon, row.names = rownames(taxonomy))
# Keep only features that have taxonomy assigned
# Find common feature IDs (preserve feature table order)
common_features <- intersect(rownames(feature_table), rownames(taxonomy_only))
# Subset matched rows
feature_table_matched <- feature_table[common_features, , drop=FALSE]
taxonomy_matched <- taxonomy_only[common_features, , drop=FALSE]
# Merge: add Taxon column as the first column, then all sample counts
merged <- cbind(taxonomy_matched, feature_table_matched)
# Save with proper column names
write.table(merged, '../Results/denoise_mode_gg/taxonomy-abundance-table.tsv',
sep='\t', quote=FALSE, row.names=TRUE)
parse_taxonomy <- function(tax_string) {
ranks <- c(Domain=NA, Phylum=NA, Class=NA, Order=NA, Family=NA, Genus=NA, Species=NA)
if (is.na(tax_string) || tax_string == '') {
ranks[is.na(ranks)] <- 'Unassigned'
return(ranks)
}
parts <- unlist(strsplit(tax_string, ';'))
for (p in parts) {
p <- trimws(p)
if (p == '' ) next
if (!grepl('^[dpcofgs]__', p)) next  # skip unexpected tokens
prefix <- substr(p, 1, 1)
value <- sub('^[dpcofgs]__', '', p)
# Normalize empty or placeholder values
if (value == '' || value == 'uncultured' || value == 'metagenome') value <- 'Unassigned'
rankName <- switch(prefix,
d='Domain', p='Phylum', c='Class', o='Order',
f='Family', g='Genus', s='Species')
ranks[rankName] <- ifelse(value == '', 'Unassigned', value)
}
ranks[is.na(ranks)] <- 'Unassigned'
return(ranks)
}
rank_matrix <- t(vapply(taxonomy_matched$Taxon, parse_taxonomy, character(7)))
rank_df <- as.data.frame(rank_matrix, stringsAsFactors = FALSE)
rownames(rank_df) <- rownames(taxonomy_matched)
merged_ranks <- cbind(rank_df, feature_table_matched)
write.table(merged_ranks, '../Results/denoise_mode_gg/final-table-with-ranks.tsv',
sep='\t', quote=FALSE, row.names=TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)
library(stringr)
library(RColorBrewer)
# Set input and output file paths
input_file <- "Results/denoise_mode_gg/final-table-with-ranks.tsv"
output_plot <- "Results/denoise_mode_gg/stacked_barplot_MOB.pdf"
# Read data
header <- scan(input_file, what = "character", nlines = 1, sep = "\t", quiet = TRUE)
setwd("/Users/jiayi/Desktop/metagenomic_pipeline/QIIME")
# Set input and output file paths
input_file <- "Results/denoise_mode_gg/final-table-with-ranks.tsv"
output_plot <- "Results/denoise_mode_gg/stacked_barplot_MOB.pdf"
# Read data
header <- scan(input_file, what = "character", nlines = 1, sep = "\t", quiet = TRUE)
data <- read.table(input_file, sep = "\t", skip = 1, header = FALSE, stringsAsFactors = FALSE)
# Fix column names
if (ncol(data) == length(header) + 1) {
colnames(data) <- c("FeatureID", header)
} else {
colnames(data) <- header
}
# Define metadata and sample columns
metadata_cols <- c("FeatureID", "Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
sample_cols <- setdiff(colnames(data), metadata_cols)
sample_cols <- setdiff(sample_cols, c("A1", "A2")) # Filter out A1, A2
# Convert to long format
long_data <- data %>%
pivot_longer(cols = all_of(sample_cols), names_to = "SampleID", values_to = "Count") %>%
filter(Count > 0) %>% # Remove zero counts to speed up
mutate(
# 1. Clean Taxonomy: Remove "f__", "g__", etc. and trim whitespace
Family = str_replace_all(Family, "[a-z]__", ""),
Genus = str_replace_all(Genus, "[a-z]__", ""),
Family = trimws(Family),
Genus = trimws(Genus)
)
# --- DEFINING TARGETS ---
# List of Genera to search for (Updated based on your data)
target_genera <- c(
"Methylacidiphilum",
"Crenothrix",
"Methylibium",
"Methylobacillus",
"Methylobacterium",
"Methylocella",
"Methylomonas",
"Methylonatrum",
"Methylophaga",
"Methylopila",
"Methylosinus",
"Methylovirgula"
)
# Create a regex pattern for matching
target_pattern <- paste(target_genera, collapse = "|")
# Filter and label data
filtered_data <- long_data %>%
mutate(
# Extract the matching genus name
MatchedGenus = str_extract(Genus, regex(target_pattern, ignore_case = TRUE)),
# Handle special cases for Unclassified Families
IsUnclassifiedMethylophilaceae = grepl("Methylophilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned"),
IsUnclassifiedMethylacidiphilaceae = grepl("Methylacidiphilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned")
) %>%
filter(!is.na(MatchedGenus) | IsUnclassifiedMethylophilaceae | IsUnclassifiedMethylacidiphilaceae) %>%
mutate(
Taxon = case_when(
!is.na(MatchedGenus) ~ str_to_title(MatchedGenus),
IsUnclassifiedMethylophilaceae ~ "Unclassified Methylophilaceae",
IsUnclassifiedMethylacidiphilaceae ~ "Unclassified Methylacidiphilaceae"
),
# Add "Candidatus" prefix if needed
Taxon = ifelse(Taxon == "Methylacidiphilum", "Candidatus Methylacidiphilum", Taxon)
)
# Check if we found anything
if (nrow(filtered_data) == 0) {
print("DEBUG: Top 20 Families found in your data (to help debug):")
print(head(sort(table(long_data$Family), decreasing=TRUE), 20))
stop("No target species found! Check the debug output above to see what Families are actually in your data.")
}
# --- RE-CALCULATE RELATIVE ABUNDANCE WITHIN MOB ---
# The reference plot sums to 100%, meaning it shows the proportion WITHIN the Methylotrophs
plot_data <- filtered_data %>%
group_by(SampleID, Taxon) %>%
summarise(Count = sum(Count), .groups = "drop") %>%
group_by(SampleID) %>%
mutate(RelativeAbundance = Count / sum(Count) * 100) %>%
ungroup()
# Add grouping info
plot_data <- plot_data %>%
mutate(Group = case_when(
grepl("B$", SampleID) ~ "Bark",
grepl("S$", SampleID) ~ "Soil",
TRUE ~ "Wood"
))
# Define Colors (Matched to your reference image + New Taxa)
mob_colors <- c(
"Candidatus Methylacidiphilum" = "#CD5C5C", # IndianRed
"Unclassified Methylacidiphilaceae" = "#CD5C5C", # Same as above (related)
"Crenothrix" = "black",
"Methylibium" = "#FF8C00", # DarkOrange
"Methylobacillus" = "#98FB98", # PaleGreen
"Methylobacterium" = "#7FFF00", # Chartreuse
"Methylocella" = "#8B4513", # SaddleBrown
"Methylomonas" = "#E6E6FA", # Lavender/White-ish
"Methylonatrum" = "#483D8B", # DarkSlateBlue
"Methylophaga" = "#800080", # Purple
"Methylopila" = "#C0C0C0", # Silver/Grey
"Methylosinus" = "#DA70D6", # Orchid
"Unclassified Methylophilaceae" = "#AFEEEE", # PaleTurquoise
"Methylovirgula" = "#FFD700" # Gold (New)
)
# Ensure factor levels match the legend order (Alphabetical usually)
plot_data$Taxon <- factor(plot_data$Taxon, levels = sort(unique(plot_data$Taxon)))
# Plotting
p <- ggplot(plot_data, aes(x = SampleID, y = RelativeAbundance, fill = Taxon)) +
geom_bar(stat = "identity", width = 0.8) +
facet_grid(~ Group, scales = "free_x", space = "free_x") +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_manual(values = mob_colors) +
labs(x = "Tree", y = "Relative abundance (%)", fill = "MOB - 16S") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5),
panel.grid = element_blank(),
strip.background = element_rect(fill = "white", colour = "black"),
strip.text = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 10, face = "italic")
)
p
View(long_data)
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)
library(stringr)
library(RColorBrewer)
setwd("/Users/jiayi/Desktop/metagenomic_pipeline/QIIME")
# Set input and output file paths
input_file <- "Results/denoise_mode/final-table-with-ranks.tsv"
output_plot <- "Results/denoise_mode/stacked_barplot_MOB.pdf"
# Read data
header <- scan(input_file, what = "character", nlines = 1, sep = "\t", quiet = TRUE)
data <- read.table(input_file, sep = "\t", skip = 1, header = FALSE, stringsAsFactors = FALSE)
# Fix column names
if (ncol(data) == length(header) + 1) {
colnames(data) <- c("FeatureID", header)
} else {
colnames(data) <- header
}
# Define metadata and sample columns
metadata_cols <- c("FeatureID", "Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
sample_cols <- setdiff(colnames(data), metadata_cols)
sample_cols <- setdiff(sample_cols, c("A1", "A2")) # Filter out A1, A2
# Convert to long format
long_data <- data %>%
pivot_longer(cols = all_of(sample_cols), names_to = "SampleID", values_to = "Count") %>%
filter(Count > 0) %>% # Remove zero counts to speed up
mutate(
# 1. Clean Taxonomy: Remove "f__", "g__", etc. and trim whitespace
Family = str_replace_all(Family, "[a-z]__", ""),
Genus = str_replace_all(Genus, "[a-z]__", ""),
Family = trimws(Family),
Genus = trimws(Genus)
)
# --- DEFINING TARGETS ---
# List of Genera to search for (Updated based on your data)
target_genera <- c(
"Methylacidiphilum",
"Crenothrix",
"Methylibium",
"Methylobacillus",
"Methylobacterium",
"Methylocella",
"Methylomonas",
"Methylonatrum",
"Methylophaga",
"Methylopila",
"Methylosinus",
"Methylovirgula"
)
# Create a regex pattern for matching
target_pattern <- paste(target_genera, collapse = "|")
# Filter and label data
filtered_data <- long_data %>%
mutate(
# Extract the matching genus name
MatchedGenus = str_extract(Genus, regex(target_pattern, ignore_case = TRUE)),
# Handle special cases for Unclassified Families
IsUnclassifiedMethylophilaceae = grepl("Methylophilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned"),
IsUnclassifiedMethylacidiphilaceae = grepl("Methylacidiphilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned")
) %>%
filter(!is.na(MatchedGenus) | IsUnclassifiedMethylophilaceae | IsUnclassifiedMethylacidiphilaceae) %>%
mutate(
Taxon = case_when(
!is.na(MatchedGenus) ~ str_to_title(MatchedGenus),
IsUnclassifiedMethylophilaceae ~ "Unclassified Methylophilaceae",
IsUnclassifiedMethylacidiphilaceae ~ "Unclassified Methylacidiphilaceae"
),
# Add "Candidatus" prefix if needed
Taxon = ifelse(Taxon == "Methylacidiphilum", "Candidatus Methylacidiphilum", Taxon)
)
# Check if we found anything
if (nrow(filtered_data) == 0) {
print("DEBUG: Top 20 Families found in your data (to help debug):")
print(head(sort(table(long_data$Family), decreasing=TRUE), 20))
stop("No target species found! Check the debug output above to see what Families are actually in your data.")
}
# --- RE-CALCULATE RELATIVE ABUNDANCE WITHIN MOB ---
# The reference plot sums to 100%, meaning it shows the proportion WITHIN the Methylotrophs
plot_data <- filtered_data %>%
group_by(SampleID, Taxon) %>%
summarise(Count = sum(Count), .groups = "drop") %>%
group_by(SampleID) %>%
mutate(RelativeAbundance = Count / sum(Count) * 100) %>%
ungroup()
# Add grouping info
plot_data <- plot_data %>%
mutate(Group = case_when(
grepl("B$", SampleID) ~ "Bark",
grepl("S$", SampleID) ~ "Soil",
TRUE ~ "Wood"
))
# Define Colors (Matched to your reference image + New Taxa)
mob_colors <- c(
"Candidatus Methylacidiphilum" = "#CD5C5C", # IndianRed
"Unclassified Methylacidiphilaceae" = "#CD5C5C", # Same as above (related)
"Crenothrix" = "black",
"Methylibium" = "#FF8C00", # DarkOrange
"Methylobacillus" = "#98FB98", # PaleGreen
"Methylobacterium" = "#7FFF00", # Chartreuse
"Methylocella" = "#8B4513", # SaddleBrown
"Methylomonas" = "#E6E6FA", # Lavender/White-ish
"Methylonatrum" = "#483D8B", # DarkSlateBlue
"Methylophaga" = "#800080", # Purple
"Methylopila" = "#C0C0C0", # Silver/Grey
"Methylosinus" = "#DA70D6", # Orchid
"Unclassified Methylophilaceae" = "#AFEEEE", # PaleTurquoise
"Methylovirgula" = "#FFD700" # Gold (New)
)
# Ensure factor levels match the legend order (Alphabetical usually)
plot_data$Taxon <- factor(plot_data$Taxon, levels = sort(unique(plot_data$Taxon)))
# Plotting
p <- ggplot(plot_data, aes(x = SampleID, y = RelativeAbundance, fill = Taxon)) +
geom_bar(stat = "identity", width = 0.8) +
facet_grid(~ Group, scales = "free_x", space = "free_x") +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_manual(values = mob_colors) +
labs(x = "Tree", y = "Relative abundance (%)", fill = "MOB - 16S") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5),
panel.grid = element_blank(),
strip.background = element_rect(fill = "white", colour = "black"),
strip.text = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 10, face = "italic")
)
p
# Set input and output file paths
input_file <- "Results/denoise_mode05/final-table-with-ranks.tsv"
output_plot <- "Results/denoise_mode05/stacked_barplot_MOB.pdf"
# Read data
header <- scan(input_file, what = "character", nlines = 1, sep = "\t", quiet = TRUE)
data <- read.table(input_file, sep = "\t", skip = 1, header = FALSE, stringsAsFactors = FALSE)
# Fix column names
if (ncol(data) == length(header) + 1) {
colnames(data) <- c("FeatureID", header)
} else {
colnames(data) <- header
}
# Define metadata and sample columns
metadata_cols <- c("FeatureID", "Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
sample_cols <- setdiff(colnames(data), metadata_cols)
sample_cols <- setdiff(sample_cols, c("A1", "A2")) # Filter out A1, A2
# Convert to long format
long_data <- data %>%
pivot_longer(cols = all_of(sample_cols), names_to = "SampleID", values_to = "Count") %>%
filter(Count > 0) %>% # Remove zero counts to speed up
mutate(
# 1. Clean Taxonomy: Remove "f__", "g__", etc. and trim whitespace
Family = str_replace_all(Family, "[a-z]__", ""),
Genus = str_replace_all(Genus, "[a-z]__", ""),
Family = trimws(Family),
Genus = trimws(Genus)
)
# --- DEFINING TARGETS ---
# List of Genera to search for (Updated based on your data)
target_genera <- c(
"Methylacidiphilum",
"Crenothrix",
"Methylibium",
"Methylobacillus",
"Methylobacterium",
"Methylocella",
"Methylomonas",
"Methylonatrum",
"Methylophaga",
"Methylopila",
"Methylosinus",
"Methylovirgula"
)
# Create a regex pattern for matching
target_pattern <- paste(target_genera, collapse = "|")
# Filter and label data
filtered_data <- long_data %>%
mutate(
# Extract the matching genus name
MatchedGenus = str_extract(Genus, regex(target_pattern, ignore_case = TRUE)),
# Handle special cases for Unclassified Families
IsUnclassifiedMethylophilaceae = grepl("Methylophilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned"),
IsUnclassifiedMethylacidiphilaceae = grepl("Methylacidiphilaceae", Family, ignore.case = TRUE) &
(Genus == "" | Genus == "uncultured" | Genus == "Unassigned")
) %>%
filter(!is.na(MatchedGenus) | IsUnclassifiedMethylophilaceae | IsUnclassifiedMethylacidiphilaceae) %>%
mutate(
Taxon = case_when(
!is.na(MatchedGenus) ~ str_to_title(MatchedGenus),
IsUnclassifiedMethylophilaceae ~ "Unclassified Methylophilaceae",
IsUnclassifiedMethylacidiphilaceae ~ "Unclassified Methylacidiphilaceae"
),
# Add "Candidatus" prefix if needed
Taxon = ifelse(Taxon == "Methylacidiphilum", "Candidatus Methylacidiphilum", Taxon)
)
# Check if we found anything
if (nrow(filtered_data) == 0) {
print("DEBUG: Top 20 Families found in your data (to help debug):")
print(head(sort(table(long_data$Family), decreasing=TRUE), 20))
stop("No target species found! Check the debug output above to see what Families are actually in your data.")
}
# --- RE-CALCULATE RELATIVE ABUNDANCE WITHIN MOB ---
# The reference plot sums to 100%, meaning it shows the proportion WITHIN the Methylotrophs
plot_data <- filtered_data %>%
group_by(SampleID, Taxon) %>%
summarise(Count = sum(Count), .groups = "drop") %>%
group_by(SampleID) %>%
mutate(RelativeAbundance = Count / sum(Count) * 100) %>%
ungroup()
# Add grouping info
plot_data <- plot_data %>%
mutate(Group = case_when(
grepl("B$", SampleID) ~ "Bark",
grepl("S$", SampleID) ~ "Soil",
TRUE ~ "Wood"
))
# Define Colors (Matched to your reference image + New Taxa)
mob_colors <- c(
"Candidatus Methylacidiphilum" = "#CD5C5C", # IndianRed
"Unclassified Methylacidiphilaceae" = "#CD5C5C", # Same as above (related)
"Crenothrix" = "black",
"Methylibium" = "#FF8C00", # DarkOrange
"Methylobacillus" = "#98FB98", # PaleGreen
"Methylobacterium" = "#7FFF00", # Chartreuse
"Methylocella" = "#8B4513", # SaddleBrown
"Methylomonas" = "#E6E6FA", # Lavender/White-ish
"Methylonatrum" = "#483D8B", # DarkSlateBlue
"Methylophaga" = "#800080", # Purple
"Methylopila" = "#C0C0C0", # Silver/Grey
"Methylosinus" = "#DA70D6", # Orchid
"Unclassified Methylophilaceae" = "#AFEEEE", # PaleTurquoise
"Methylovirgula" = "#FFD700" # Gold (New)
)
# Ensure factor levels match the legend order (Alphabetical usually)
plot_data$Taxon <- factor(plot_data$Taxon, levels = sort(unique(plot_data$Taxon)))
# Plotting
p <- ggplot(plot_data, aes(x = SampleID, y = RelativeAbundance, fill = Taxon)) +
geom_bar(stat = "identity", width = 0.8) +
facet_grid(~ Group, scales = "free_x", space = "free_x") +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_manual(values = mob_colors) +
labs(x = "Tree", y = "Relative abundance (%)", fill = "MOB - 16S") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5),
panel.grid = element_blank(),
strip.background = element_rect(fill = "white", colour = "black"),
strip.text = element_text(size = 12),
legend.position = "right",
legend.text = element_text(size = 10, face = "italic")
)
p
